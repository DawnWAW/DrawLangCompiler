# 语言定义

## 基本设计

### 1. 确定核心语法要素

| 要素类型  | 具体内容                                                     |
| --------- | ------------------------------------------------------------ |
| 保留字    | ORIGIN、SCALE、ROT、IS、FOR、FROM、TO、STEP、DRAW、STYLE     |
| 运算符    | +（加）、-（减）、*（乘）、/（除）、**（幂运算）             |
| 常量/参数 | 数值常量（如3.14、5）、符号常量（PI=3.14159、E=2.71828）、参数T |
| 函数      | sin、cos、tan、sqrt、exp、ln（基础数学函数）                 |
| 分隔符    | ;（语句结束）、( )（括号）、,（坐标分隔）                    |
| 注释      | //、--、# 单行注释，/* */ 多行注释                           |
| 颜色      | RED、BLUE、GREEN、YELLOW、BLACK、WHITE                       |

### 2. 确定核心语句格式

1. **原点语句**：`ORIGIN IS (表达式, 表达式);`

2. **缩放语句**：`SCALE IS (表达式, 表达式);`

3. **旋转语句**：`ROT IS 表达式;`

4. **样式语句**：`STYLE IS STYLEVALUE;`

5. **绘图语句**：`FOR T FROM 表达式 TO 表达式 STEP 表达式 DRAW (表达式, 表达式);`

6. **注释语句**: `--`、`//`、`#`或`/* */`

### 3. 确定语义规则（固定核心逻辑）

- 坐标体系：笛卡尔坐标系，x向右增，y向上增（数学常规坐标系）
- 图形变换顺序：**比例变换 → 旋转变换 → 平移变换**（实验固定规则，无需灵活配置）
- 默认值：原点(0,0)、缩放(1,1)、旋转0（不旋转）、样式(黑色, 不透明, 线宽1.0)
- 替换规则: `ORIGIN`、`ROT`、`SCALE` 和 `STYLE` 语句只影响其后的绘图语句，且遵循最后出现的语句有效的原则。
- 大小写不敏感: 语言对大小写不敏感
- 双精度表达式: 语句中表达式的值均为双精度类型
- 旋转角度: 弧度单位, 逆时针旋转
- 平移单位: 像素点单位



## 语句定义

### 循环绘图(FOR-DRAW)语句

`FOR T FROM 起点表达式 TO 终点表达式 STEP 步长表达式 DRAW (横坐标, 纵坐标);`

-   语义: 令T从起点到终点、每次改变一个步长，绘制出由(横坐标，纵坐标)所规定的点的轨迹。
-   例子: 如`FOR T FROM 0 TO 2*PI STEP PI/50 DRAW (cos(T), sin(T));`
-   说明: 该语句的作用是令T从0到2*PI、步长 PI/50，绘制出各个点的坐标(cos(T)，sin(T))，即一个单位圆。



### 比例设置(SCALE)语句

`SCALE IS (横坐标比例因子, 纵坐标比例因子);`

-   语义: 设置横坐标和纵坐标的比例，并分别按照比例因子进行缩放
-   举例: 如`SCALE IS (50, 50);`
-   说明: 将横坐标和纵坐标的比例设置为1:1，且放大50倍。



### 坐标平移(ORIGIN)语句

`ORIGIN IS (表达式, 表达式);`

-   语义: 将坐标系的原点平移到横坐标和纵坐标规定的点处。
-   举例: 如`ORIGIN IS (300, 200);`
-   说明: 将原点从(0, 0)平移到(300, 200) 处。



### 角度旋转(ROT)语句

`ROT IS 表达式;`

-   语义: 绕原点逆时针旋转弧度值所规定的角度
    -   计算公式：
    -   $旋转后X = 旋转前X \times \cos(弧度)+旋转前Y \times \sin(弧度) 	$
    -   $旋转后Y = 旋转前Y \times \cos(弧度)-旋转前X \times \sin(弧度)$
-   举例: 如`ROT IS PI/2;`



### 样式设置(STYLE)语句

`STYLE IS STYLEVALUE;`

-   语义: 设置绘图的颜色、透明度和线条宽度
-   STYLEVALUE的格式：
    1. `COLOR`：仅设置颜色，如 `STYLE IS RED;`
    2. `CONST_ID`：仅设置线条宽度，如 `STYLE IS 2.0;`
    3. `(COLOR[, OPACITY[, LINE_WIDTH]])`：设置颜色、透明度和线条宽度，如 `STYLE IS (RED, 0.5, 2.0);`
-   默认值：颜色为黑色，透明度为1.0（不透明），线条宽度为1.0



### 注释语句

支持四种注释方式：

1. `//`：单行注释（忽略到行尾）
2. `--`：单行注释（忽略到行尾）
3. `#`：单行注释（忽略到行尾）
4. `/* */`：多行注释（可跨越多行）

-   语义: 屏蔽掉注释性的语句
